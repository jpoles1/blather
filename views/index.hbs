<html>
  <head>
    <script type="text/javascript" src="res/js/jquery-2.2.1.min.js"></script>
    <script type="text/javascript" src="res/js/annyang.js"></script>
  </head>
  <body>
    <div id="notify" style="font-size: 52pt;">
    </div>
    <script>
    var commandReady = 0;
    var ready_time = 10; //In seconds
    $(function(){
      if (annyang) {
        console.log("Starting to listen")
        // Let's define our first command. First the text we expect, and then the function it should call
        var commands = {
          'hey (domo)': function() {
            $("#notify").html("Heard Keyword!");
            commandReady = 1;
            setTimeout(function(){
              commandReady = 0;
              $("#notify").html("");
            }, ready_time*1000);
          },
          'lights *tag': function(tag) {
            if(commandReady){
              $("#notify").html("Setting lights to: "+tag)
              commandReady = 0;
              $.post("lights", {"command": tag}, function(res){
                console.log(res)
              })
              setTimeout(function(){$("#notify").html("");}, 3*1000);
            }
          }
        };
        annyang.debug();

        // Add our commands to annyang
        annyang.addCommands(commands);

        // Start listening. You can call this here, or attach this call to an event, button, etc.
        annyang.start();
      }
    });
    </script>
  </body>
</html>
